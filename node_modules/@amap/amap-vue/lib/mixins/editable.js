"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("../utils/common.js"),i=require("./mixins.js"),e=require("./props.js"),a=require("./component.js");const o=i.default(a.default).extend({data:()=>({$editor:null}),props:{editable:e.defineProp({type:Boolean,default:!1,initialize:!1})},computed:{$editable(){return this.$meta.editable}},async mounted(){await this.$context.ready;const t=this.$options.amapMeta.editable;this.editable&&t.startEditing.call(this)},beforeDestroy(){const{$editor:t,$context:i}=this;if(t){if(this.$options.amapMeta.editable.events.forEach(i=>{t.off(i,this.$onAmapEdit)}),t.close(),i&&i.target){i.target.setMap(null)}}},watch:{"$props.editable"(t){const{$editable:i,$context:e}=this;t?e.destroyed||i.startEditing.call(this):i.endEditing.call(this)}}});var s=i.default(o).extend({amapMeta:{editable:{events:[],loadEditor:t.panic,initEditor:t.panic,onEdit:t.panic,async initEditing(){if(this.$editor)return this.$editor;const t=this.$options.amapMeta.editable,{$container:i,$context:e,$editable:a,$map:o}=this;await i.ready,await a.loadEditor();const{AMap:s}=e;this.$editor=await t.initEditor.call(this,s,o,e.target);const n=this.$onAmapEdit=t.onEdit.bind(this);return t.events.forEach(t=>{this.$editor.on(t,n)}),this.$editor},async startEditing(){const{$editable:t}=this;(await t.initEditing.call(this)).open()},endEditing(){this.$editor&&this.$editor.close()}}}});exports.default=s;
