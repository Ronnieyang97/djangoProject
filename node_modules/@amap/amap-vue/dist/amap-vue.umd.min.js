!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("vue")):"function"==typeof define&&define.amd?define(["exports","vue"],t):t((e=e||self).AmapVue={},e.Vue)}(this,(function(e,t){"use strict";t=t&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t;var n={_prefix:"https://webapi.amap.com/maps",_disableMapCache:!1,verbose:!1,timing:!1,version:"2.0",key:"",plugins:[]};function o(){const e={};return e.promise=new Promise((t,n)=>{e.resolve=t,e.reject=n}),e}const r=o();let a=!1,i=!1;const s=r.promise;function p(){if(!i){if(i=!0,window.AMap)return r.resolve(window.AMap),s;const e=document.createElement("script"),t=`amap_vue_${Date.now()}_${Math.ceil(1e4*Math.random())}`,o=()=>{a||(a=!0,r.resolve(window.AMap))};window[t]=o;const p=function(e){const t=[];for(const n in e)void 0!==e[n]&&null!==e[n]&&t.push(`${n}=${encodeURIComponent(e[n])}`);return t.join("&")}({v:n.version,key:n.key,callback:t,plugin:n.plugins.join(",")}),l=`${n._prefix}?${p}`;e.src=l,document.body.appendChild(e)}return s}async function l(e){const t=await p();return new Promise(n=>{t.plugin(e,()=>{n()})})}var c=t.extend({inject:["$amapMap"],computed:{$map(){return this.$amapMap.target}}});function d(e){throw new Error(e)}function u(e,...t){const[n,...o]=t;if(!n)return e;const r=new Set(e);return n.forEach(t=>{r.has(t)||e.push(t)}),u(e,...o)}const m=Object.prototype.hasOwnProperty;function y(e){try{if(e.constructor&&!m.call(e,"constructor")&&!m.call(e.constructor.prototype,"isPrototypeOf"))return!1}catch(e){return!1}let t;for(t in e);return void 0===t||m.call(e,t)}function f(...e){return t.extend({mixins:e||[]})}function h(e,t,o){n.verbose&&"function"==typeof console[t]&&(e&&e.$options&&e.$options.name&&(o=[`[${e.$options.name}]`,...o]),console[t](...o))}function g(...e){h(this,"warn",e)}function v(...e){h(this,"debug",e)}function b(e){return{warn:g.bind(e),debug:v.bind(e)}}function w(e,t){return null!=t&&e instanceof t}function $(e,t,n,o,r){"object"==typeof t&&(n=t.depth,o=t.prototype,r=t.includeNonEnumerable,t=t.circular);let a=[],i=[];return void 0===t&&(t=!0),void 0===n&&(n=1/0),function e(n,s){if(null===n)return null;if(0===s)return n;let p,l;if("object"!=typeof n)return n;if(w(n,Map))p=new Map;else if(w(n,Set))p=new Set;else if(w(n,Promise))p=new Promise((function(t,o){n.then((function(n){t(e(n,s-1))}),(function(t){o(e(t,s-1))}))}));else if($.__isArray(n))p=[];else if($.__isRegExp(n))p=new RegExp(n.source,C(n)),n.lastIndex&&(p.lastIndex=n.lastIndex);else if($.__isDate(n))p=new Date(n.getTime());else if(w(n,Error))p=Object.create(n);else if(void 0===o){if(l=Object.getPrototypeOf(n),w(l,Object))return n;p=Object.create(l)}else p=Object.create(o),l=o;if(t){let e=a.indexOf(n);if(-1!=e)return i[e];a.push(n),i.push(p)}w(n,Map)&&n.forEach((function(t,n){let o=e(n,s-1),r=e(t,s-1);p.set(o,r)})),w(n,Set)&&n.forEach((function(t){let n=e(t,s-1);p.add(n)}));for(let t in n){Object.getOwnPropertyDescriptor(n,t)&&(p[t]=e(n[t],s-1));try{if(void 0===Object.getOwnPropertyDescriptor(n,t).set)continue;p[t]=e(n[t],s-1)}catch(e){if(e instanceof TypeError)continue;if(e instanceof ReferenceError)continue}}if(Object.getOwnPropertySymbols){let t=Object.getOwnPropertySymbols(n);for(let o=0;o<t.length;o++){let a=t[o],i=Object.getOwnPropertyDescriptor(n,a);(!i||i.enumerable||r)&&(p[a]=e(n[a],s-1),Object.defineProperty(p,a,i))}}if(r){let t=Object.getOwnPropertyNames(n);for(let o=0;o<t.length;o++){let r=t[o],a=Object.getOwnPropertyDescriptor(n,r);a&&a.enumerable||(p[r]=e(n[r],s-1),Object.defineProperty(p,r,a))}}return p}(e,n)}function M(e){return Object.prototype.toString.call(e)}function C(e){let t="";return e.global&&(t+="g"),e.ignoreCase&&(t+="i"),e.multiline&&(t+="m"),t}function A(e){const t=[];for(;Array.isArray(e);)t.push(e.length),e=e[0];return t}function x(e,t){return!(!e&&t)&&(!(e&&!t)&&(e===t||e.length===t.length&&e.every((e,n)=>e===t[n])))}function k(e,t){return!(!e&&t)&&(!(e&&!t)&&(e===t||e[0]===t[0]&&e[1]===t[1]))}function E(e,t){if(!e&&t)return!1;if(e&&!t)return!1;if(!e&&!t)return!0;if(e===t)return!0;if(e.length!==t.length)return!1;const n=A(e);return!!x(n,A(t))&&(2===n.length?e.every((e,n)=>k(e,t[n])):3===n.length&&e.every((e,n)=>E(e,t)))}t.mixin({beforeCreate(){this.$options}}),t.config.optionMergeStrategies.amapMeta=(e,t)=>function e(t,n){const o={...t};for(const r in n){const a=n[r],i=t[r];Array.isArray(a)?o[r]=u(i||[],a):y(a)?o[r]=e(i||{},a):o[r]=a}return o}(e||{},t||{}),$.clonePrototype=function(e){if(null===e)return null;let t=function(){};return t.prototype=e,new t},$.__objToStr=M,$.__isDate=function(e){return"object"==typeof e&&"[object Date]"===M(e)},$.__isArray=function(e){return"object"==typeof e&&"[object Array]"===M(e)},$.__isRegExp=function(e){return"object"==typeof e&&"[object RegExp]"===M(e)},$.__getRegExpFlags=C;function O(e,t,n=1e-7){return Math.abs(e-t)<n}function S(e,t){return!(!e&&t)&&(!(e&&!t)&&(e===t||O(e[0],t[0])&&O(e[1],t[1])))}const B=new WeakMap;function L(e,t){let n=B.get(t);if(!n){n=new Map,B.set(t,n);for(const e in t){const o=t[e];!1!==o.initialize&&n.set(e,o)}}return n.get(e)}function _(e,t,n,o){void 0===t&&(t=e.$options.props),void 0===n&&(n=e.$props);const r={};for(const o in n){const a=n[o];if(void 0===a)continue;const i=L(o,t);i&&(r[o]=i.transform?i.transform.call(e,a):a)}return o?r:$(r)}function j(e){return e?Array.isArray(e)?[e[0],e[1]]:[e.lng,e.lat]:[]}function P(e){return Array.isArray(e)?e:e.southWest?[[e.southWest.lng,e.southWest.lat],[e.northEast.lng,e.northEast.lat]]:[[e.southwest.lng,e.southwest.lat],[e.northeast.lng,e.northeast.lat]]}function T(e){if(!Array.isArray(e))return[];const t=A(e);return 1===t.length||2===t.length?e.map(j):3===t.length?e.map(e=>e.map(j)):[]}function z(e){const t=new AMap.LngLat(e[0][0],e[0][1]),n=new AMap.LngLat(e[1][0],e[1][1]);return new AMap.Bounds(t,n)}function D(e){return(t,n)=>{t.setOptions({[e]:n})}}function N(e,t,n){const o=e.$amap.events||(e.$amap.events={});(o[t]||(o[t]=[])).push(n)}function I(e){const{events:t=[]}=e.$options.amapMeta,n=e.$amap.context.target;t.forEach(t=>{e.$watch("$listeners."+t,(o,r)=>{r&&n.off(t,r),o&&(N(e,t,o),n.on(t,o))},{immediate:!0})})}function R(e,t,n,o){o||(o=e.$amap.context.target);const{events:r=[]}=n;r.forEach(r=>{const{getter:a}=n;if(!a)return;const i=r=>{const i="function"==typeof a?a.call(e,o,r):o[a](),s=e.$props[t];if("function"==typeof n.equals){if(n.equals(i,s))return}else if(i===s)return;e.$emit("update:"+t,i)};N(e,r,i),o.on(r,i)})}function q(e){const t=e.$amap.context.target,n=e.$amap.events||{};for(const e in n){n[e].forEach(n=>{t.off(e,n)})}}const W={equals:function(e,t){return e===t},clone:!1};function Z(e,t,n,o){const{setter:r}=n;r&&("function"==typeof r?r.call(e,t,o):"string"==typeof r&&(n.clone&&(o=$(o)),t[r](o)))}function F(e,t,n){t||(t=e.$amap.context.target),n||(n=e.$options.props);for(const o in n){const r=n[o],{setter:a}=r;if(!a)continue;const i={deep:!!r.deep};e.$amap.logger.debug("watch",o,i),e.$watch("$props."+o,(n,o)=>{if(!i.deep||i.deep&&n!==o)if("function"==typeof r.equals){if(r.equals(n,o))return}else if(n===o)return;Z(e,t,r,n)},i),r.events&&R(e,o,r,t)}}function U(e,t,n){if("string"==typeof e){const o=e,r={...W,setter:o};return t&&(r.type=t),arguments.length>=3&&(r.default=n),r}return{...W,...e}}function H(e){return function(t,n){t.setStatus({[e]:n})}}var V=t.extend({name:"Amap",amapMeta:{events:["click","dblclick","rightclick","mapmove","movestart","moveend","hotspotclick","hotspotover","hotspotout","mousemove","mousewheel","mouseover","mouseup","mousedown","zoomchange","zoomstart","zoomend","dragstart","dragging","dragend","resize","touchstart","touchmove","touchend"]},props:{cacheKey:U({type:String,initialize:!1}),center:U({type:Array,deep:!0,equals:k,setter(e,t){if(!t)return;S(t,j(e.getCenter()))||e.setCenter([t[0],t[1]])},getter:e=>j(e.getCenter()),events:["mapmove","moveend"]}),zoom:U({type:Number,equals:O,setter(e,t){if(void 0===t)return;O(e.getZoom(),t)||e.setZoom(t)},getter:"getZoom",events:["zoomchange","zoomend"]}),rotation:U({type:Number,equals:O,setter:"setRotation",getter:"getRotation",events:["dragging","dragend","moveend","rotateend"]}),pitch:U({type:Number,equals:O,setter:"setPitch",getter:"getPitch",events:["dragging","dragend","moveend","pitchend"]}),viewMode:{type:String},features:U("setFeatures",Array),zooms:{type:Array},dragEnable:U({type:Boolean,default:void 0,setter:H("dragEnable")}),zoomEnable:U({type:Boolean,default:void 0,setter:H("zoomEnable")}),jogEnable:U({type:Boolean,default:void 0,setter:H("jogEnable")}),pitchEnable:U({type:Boolean,default:void 0,setter:H("pitchEnable")}),rotateEnable:U({type:Boolean,default:void 0,setter:H("rotateEnable")}),animateEnable:U({type:Boolean,default:void 0,setter:H("animateEnable")}),keyboardEnable:U({type:Boolean,default:void 0,setter:H("keyboardEnable")}),doubleClickZoom:U({type:Boolean,default:void 0,setter:H("doubleClickZoom")}),scrollWheel:U({type:Boolean,default:void 0,setter:H("scrollWheel")}),touchZoom:{type:Boolean,default:void 0},touchZoomCenter:{type:Boolean,default:void 0},showLabel:{type:Boolean,default:void 0},defaultCursor:U("setDefaultCursor",String),isHotspot:U({type:Boolean,default:void 0,setter:H("isHotspot")}),mapStyle:U("setMapStyle",String),wallColor:{type:String},roofColor:{type:String},skyColor:{type:String},showBuildingBlock:{type:Boolean,default:void 0},showIndoorMap:U({type:Boolean,default:void 0,setter:H("showIndoorMap")}),mask:{type:Array}},data:()=>({ready:!1}),computed:{$context(){return this.$amap.context},$map(){return this.$context.target}},methods:{_clear(){const{$context:e}=this;e.ready.then(()=>{q(this);const{$map:e}=this;e.clearMap(),e.clearInfoWindow()})},_getContainer(e){const{cacheKey:t}=this;if(!n._disableMapCache&&t){const n="amap-vue-container-inner-"+t;let o=document.getElementById(n)||this.$el.querySelector("#"+n);return o||(o=document.createElement("div"),o.className="amap-vue-container-inner",o.setAttribute("id",n),o.setAttribute("style","position:relative; width:100%; height:100%;")),e?(this.$el.insertAdjacentElement("afterbegin",o),o.style.display="block",o.style.pointerEvents="initial"):(o.style.display="none",o.style.pointerEvents="none"),o}return this.$el}},beforeCreate(){p();const e=o(),t={AMap:null,wrapper:null,ready:e.promise,target:null,vm:this,destroyed:!1};this.$amap={events:{},ready:e,context:t,logger:b(this)}},async mounted(){const{$context:e}=this,t=await p();if(e.AMap=t,e.destroyed)return;const n=_(this),o=this._getContainer(!0),r=!!o.$amap;if(r)for(let e in n){const t=this.$options.props[e],r=n[e];Z(this,o.$amap,t,r)}else o.$amap=new t.Map(o,n);const a=o.$amap;e.wrapper=o,e.target=a,F(this),I(this);const i=async()=>{this.ready=!0,this.$amap.ready.resolve(a),await this.$nextTick(),this.$emit("complete",a)};r?i():a.on("complete",i)},destroyed(){const{$context:e}=this;if(!n._disableMapCache&&this.cacheKey){const e=this._getContainer(!1);document.body.appendChild(e),this._clear()}else e.target&&e.target.destroy();e.destroyed=!0},provide(){return{$amapMap:this.$context}},render(e){let t=this.$slots.default;return this.ready||(t=void 0),e("div",{class:"amap-vue-container",style:"position:relative; width:100%; height:100%;"},t)}}),K=t.extend({computed:{$context(){return this.$amap.context},$container(){return this.$amapMap},$target(){return this.$context.target},$map(){return this.$amapMap.target},$meta(){return this.$options.amapMeta}}}),J=f(K).extend({inject:["$amapMap"],amapMeta:{slot:!1,initComponent:d,add(e,t){t.setMap(e.target)},remove(e,t){t.setMap(null)}},beforeCreate(){const e=o(),t={AMap:null,ready:e.promise,target:null,vm:this,destroyed:!1};this.$amap={events:{},ready:e,context:t,logger:b(this)}},async mounted(){const{$amap:e,$context:t,$container:n}=this,o=this.$options.amapMeta;await n.ready,t.AMap=n.AMap,o.prepare&&await o.prepare();const r=_(this);if(t.destroyed)return;const a=await o.initComponent.call(this,t.AMap,r);t.target=a,o.add.call(this,n,a),F(this),I(this),e.ready.resolve(a),this.$emit("amap-ready",a)},beforeDestroy(){const{$context:e,$container:t,$target:n}=this;if(n){q(this),this.$options.amapMeta.remove.call(this,t,n)}e.destroyed=!0},render(e){return this.$options.amapMeta.slot&&this.$slots.default?e("div",{class:"amap-vue-placeholder",style:"visibility: hidden; pointer-events: none;"},this.$slots.default):null}});function G(e,t,n,o){"function"==typeof e[n]?e[n](o):"function"==typeof e.setOptions&&e.setOptions({[t]:o})}function Y(e,n="show",o="hide"){return t.extend({props:{visible:U({type:Boolean,default:e,setter(e,t){t?e[n]():e[o]()}})}})}const Q=t.extend({props:{zIndex:U({type:Number,setter(e,t){G(e,"zIndex","setzIndex",t)}})}}),X=t.extend({props:{opacity:U("setOpacity",Number)}}),ee=t.extend({props:{zooms:U({type:Array,deep:!0,equals:k,setter(e,t){G(e,"zooms","setZooms",t)}})}});var te=f(J,Y(!0),Q).extend({amapMeta:{events:["click","dblclick","rightclick","mousemove","mouseover","mouseout","mousedown","mouseup","dragstart","dragging","dragend","moving","moveend","movealong","touchstart","touchmove","touchend"]},props:{cursor:U({type:String,setter(e,t){"function"==typeof e.setCursor?e.setCursor(t):"function"==typeof e.setOptions&&e.setOptions({cursor:t})}}),bubble:U("setBubble",Boolean,void 0),clickable:U("setClickable",Boolean,void 0),draggable:U("setDraggable",Boolean,void 0),extData:U("setExtData",Object)},async mounted(){const{$context:e}=this;await e.ready,e.destroyed||this.visible||e.target.hide()}});const ne=["top-left","top-center","top-right","middle-left","center","middle-right","bottom-left","bottom-center","bottom-right"],oe=["miter","round","bevel"],re=["butt","round","square"],ae=["solid","dashed"];var ie=f(te,ee).extend({props:{position:U({type:Array,deep:!0,equals:k,setter(e,t){if(!t)return;S(t,j(e.getPosition()))||e.setPosition([t[0],t[1]])},getter:e=>j(e.getPosition()),events:["dragging","dragend","moving","moveend"]}),title:U("setTitle",String),offset:U({type:Array,deep:!0,equals:k,setter(e,t){const n=e;var o;t&&(S(t,(o=n.getOffset(),Array.isArray(o)?[o[0],o[1]]:[o.x,o.y]))||n.setOffset(new window.AMap.Pixel(t[0],t[1])))},transform:e=>new window.AMap.Pixel(e[0],e[1])}),anchor:U({type:String,setter:"setAnchor",validator:e=>ne.includes(e)}),angle:U({type:Number,equals:O,setter(e,t){void 0!==t&&e.setAngle(t)},getter:e=>e.getAngle(),events:["moving"]}),topWhenClick:{type:Boolean,default:void 0}},beforeDestroy(){const e=this.$context.target;e&&"function"==typeof e.stopMove&&e.stopMove()}});function se(e){if(!e)return;const t={...e};return t.offset&&(t.offset=new window.AMap.Pixel(t.offset[0],t.offset[1])),t}function pe(e){return"string"==typeof e?e:new window.AMap.Icon(e)}var le=f(ie).extend({name:"AmapMarker",amapMeta:{slot:!0,async initComponent(e,t){const n={...t};return this.$slots.default&&this.$slots.default.length>0&&(n.content=this.$slots.default[0].elm),new e.Marker(n)}},props:{content:U("setContent",String),icon:U({setter(e,t){if(!t)return;const n=pe(t);e.setIcon(n)},transform:pe}),label:U({type:Object,setter(e,t){t&&e.setLabel(se(t))},deep:!0,transform:se})}}),ce=f(J,Y(!0),Q,X,ee).extend({name:"AmapLabelsLayer",amapMeta:{slot:!0,initComponent:async(e,t)=>new e.LabelsLayer(t)},props:{visible:U({type:Boolean,default:!0,setter(e,t){const n=e;t?n.show():n.hide()}}),zIndex:U("setzIndex",Number),opacity:U("setOpacity",Number),collision:U({type:Boolean,default:void 0,setter:"setCollision"}),allowCollision:U({type:Boolean,default:void 0,setter:"setAllowCollision"})},provide(){return{$amapLabelsLayer:this.$context}},data:()=>({ready:!1}),mounted(){this.$context.ready.then(()=>this.ready=!0)},render(e){let t=this.$slots.default;return this.ready||(t=void 0),e("div",{class:"amap-vue-labels-layer",style:"visibility: hidden; pointer-events: none;"},t)}}),de=f(J,Y(!0),Q,X,ee).extend({name:"AmapLabelMarker",inject:["$amapLabelsLayer"],amapMeta:{initComponent:async(e,t)=>new e.LabelMarker(t),async add(e,t){const n=this.$layer;n&&n.add(t)},async remove(e,t){const n=this.$layer;n&&n.remove(t)},events:["mousedown","mouseup","touchstart","touchmove","touchend","click","mousemove","mouseover","mouseout"]},props:{name:U("setName",String),position:U({type:Array,deep:!0,equals:k,setter(e,t){if(!t)return;S(t,j(e.getPosition()))||e.setPosition([t[0],t[1]])}}),rank:U("setRank",Number),icon:U({type:Object,setter:"setIcon",deep:!0}),text:U({type:Object,setter:"setText",deep:!0})},computed:{$layerContext(){return this.$amapLabelsLayer},$layer(){const{$layerContext:e}=this;return e?e.target:null}},mounted(){const{$layerContext:e}=this;if(!e)throw new Error("LabelMarker 需要与 LabelsLayer 配合使用")}}),ue=f(ie).extend({name:"AmapText",amapMeta:{initComponent:async(e,t)=>(t.domStyle&&(t.style=t.domStyle,delete t.domStyle),new e.Text(t))},props:{text:U({type:[String,Object],setter:"setText"}),domStyle:U({type:Object,setter(e,t){e.setStyle(t)},deep:!0})}});const me=f(te).extend({props:{strokeColor:U({type:String,setter:D("strokeColor")}),strokeOpacity:U({type:Number,setter:D("strokeOpacity")}),strokeWeight:U({type:Number,setter:D("strokeWeight")}),strokeStyle:U({type:String,setter:D("strokeStyle"),validator:e=>ae.includes(e)}),strokeDasharray:U({type:Array,deep:!0,equals:x,setter:D("strokeDasharray")})}}),ye=f(me).extend({props:{fillColor:U({type:String,setter:D("fillColor")}),fillOpacity:U({type:Number,setter:D("fillOpacity")})}}),fe=f(me).extend({props:{lineJoin:U({type:String,setter:D("lineJoin"),validator:e=>oe.includes(e)}),lineCap:U({type:String,setter:D("lineCap"),validator:e=>re.includes(e)}),showDir:U({type:Boolean,default:void 0,setter:D("showDir")}),dirColor:U({type:String,setter:D("dirColor")}),dirImg:U({type:Object,setter:D("dirImg")}),isOutline:U({type:Boolean,default:void 0,setter:D("isOutline")}),outlineColor:U({type:String,setter:D("outlineColor")}),borderWeight:U({type:Number,setter:D("borderWeight")}),geodesic:U({type:Boolean,default:void 0,setter:D("geodesic")})}});var he=f(ye).extend({props:{center:U({type:Array,clone:!0,deep:!0,equals:k,setter(e,t){if(t){if(this.$props.draggable||this.$props.editable){if(S(t,j(e.getCenter())))return}e.setCenter([t[0],t[1]])}},getter:e=>j(e.getCenter()),events:["dragging","dragend"]}),radius:U({type:Number,setter:"setRadius"})}});const ge=f(K).extend({data:()=>({$editor:null}),props:{editable:U({type:Boolean,default:!1,initialize:!1})},computed:{$editable(){return this.$meta.editable}},async mounted(){await this.$context.ready;const e=this.$options.amapMeta.editable;this.editable&&e.startEditing.call(this)},beforeDestroy(){const{$editor:e,$context:t}=this;if(e){if(this.$options.amapMeta.editable.events.forEach(t=>{e.off(t,this.$onAmapEdit)}),e.close(),t&&t.target){t.target.setMap(null)}}},watch:{"$props.editable"(e){const{$editable:t,$context:n}=this;e?n.destroyed||t.startEditing.call(this):t.endEditing.call(this)}}});var ve=f(ge).extend({amapMeta:{editable:{events:[],loadEditor:d,initEditor:d,onEdit:d,async initEditing(){if(this.$editor)return this.$editor;const e=this.$options.amapMeta.editable,{$container:t,$context:n,$editable:o,$map:r}=this;await t.ready,await o.loadEditor();const{AMap:a}=n;this.$editor=await e.initEditor.call(this,a,r,n.target);const i=this.$onAmapEdit=e.onEdit.bind(this);return e.events.forEach(e=>{this.$editor.on(e,i)}),this.$editor},async startEditing(){const{$editable:e}=this;(await e.initEditing.call(this)).open()},endEditing(){this.$editor&&this.$editor.close()}}}}),be=f(he,ve).extend({name:"AmapCircle",amapMeta:{initComponent:async(e,t)=>new e.Circle(t),editable:{events:["end","move","adjust"],async loadEditor(){await l("AMap.CircleEditor")},async initEditor(e,t,n){return new e.CircleEditor(t,n,this.draggable)},onEdit(e){const t=e.target,n=t.getCenter();this.$emit("update:center",[n.lng,n.lat]),this.$emit("update:radius",t.getRadius())}}}}),we=f(he).extend({name:"AmapCircleMarker",amapMeta:{initComponent:async(e,t)=>new e.CircleMarker(t)}});function $e(e){return f(me,ve).extend({amapMeta:{editable:{events:["end","move","adjust","addnode","removenode","add"],async loadEditor(){await l("AMap."+e)},async initEditor(t,n,o){return new t[e](n,o,this.draggable)},onEdit(e){const t=e.target.getPath().map(j);this.$emit("update:path",t)}}},props:{path:U({type:Array,setter(e,t){if(this.$props.draggable||this.$props.editable){if(E(T(e.getPath()),t))return}e.setPath(t)},getter:e=>T(e.getPath()),clone:!0,equals:E,events:["dragging","dragend"]})}})}var Me=f(ye,$e("PolygonEditor")).extend({name:"AmapPolygon",amapMeta:{initComponent:async(e,t)=>new e.Polygon(t)}}),Ce=f($e("PolylineEditor"),fe).extend({name:"AmapPolyline",amapMeta:{initComponent:async(e,t)=>new e.Polyline(t)}});const Ae="undefined"!=typeof BigInt64Array;function xe(e,t){if(e===t)return!0;if(e&&t&&"object"==typeof e&&"object"==typeof t){if(e.constructor!==t.constructor)return!1;if(Array.isArray(e)){const n=e.length;if(n!=t.length)return!1;for(let o=n;0!=o--;)if(!xe(e[o],t[o]))return!1;return!0}if(e instanceof Map){if(e.size!==t.size)return!1;for(const n of e.entries())if(!t.has(n[0]))return!1;for(const n of e.entries())if(!xe(n[1],t.get(n[0])))return!1;return!0}if(e instanceof Set){if(e.size!==t.size)return!1;for(const n of e.entries())if(!t.has(n[0]))return!1;return!0}if(e.constructor.BYTES_PER_ELEMENT&&(e instanceof Int8Array||e instanceof Uint8Array||e instanceof Uint8ClampedArray||e instanceof Int16Array||e instanceof Uint16Array||e instanceof Int32Array||e instanceof Uint32Array||e instanceof Float32Array||e instanceof Float64Array||Ae&&(e instanceof BigInt64Array||e instanceof BigUint64Array))){const n=e.length;if(n!=t.length)return!1;for(let o=n;0!=o--;)if(e[o]!==t[o])return!1;return!0}if(e.constructor===RegExp)return e.source===t.source&&e.flags===t.flags;if(e.valueOf!==Object.prototype.valueOf)return e.valueOf()===t.valueOf();if(e.toString!==Object.prototype.toString)return e.toString()===t.toString();const n=Object.keys(e),o=n.length;if(o!==Object.keys(t).length)return!1;for(let e=o;0!=e--;)if(!Object.prototype.hasOwnProperty.call(t,n[e]))return!1;for(let r=o;0!=r--;){const o=n[r];if(!xe(e[o],t[o]))return!1}return!0}return e!=e&&t!=t}function ke(e){return e||[]}var Ee=f(fe,ve).extend({name:"AmapBezierCurve",amapMeta:{initComponent:async(e,t)=>new e.BezierCurve(t),editable:{events:["end","adjust","addnode","removenode"],async loadEditor(){await l("AMap.BezierCurveEditor")},async initEditor(e,t,n){return new e.BezierCurveEditor(t,n,this.draggable)},onEdit(e){const t=e.target.getPath();this.$emit("update:path",ke(t))}}},props:{path:U({type:Array,setter(e,t){if(this.$props.editable||this.$props.editable){if(xe(ke(e.getPath()),t))return}e.setPath(t)},getter:e=>ke(e.getPath()),clone:!0,equals:xe,events:["dragging","dragend"]})}});function Oe(e,t){return!(!e||!t)&&(O(e[0][0],t[0][0])&&O(e[0][1],t[0][1])&&O(e[1][0],t[1][0])&&O(e[1][1],t[1][1]))}var Se=f(ye,ve).extend({name:"AmapRectangle",amapMeta:{initComponent:async(e,t)=>new e.Rectangle(t),editable:{events:["move","end","adjust"],async loadEditor(){await l("AMap.RectangleEditor")},async initEditor(e,t,n){return new e.RectangleEditor(t,n,this.draggable)},onEdit(e){const t=P(e.target.getBounds());this.$emit("update:bounds",t)}}},props:{bounds:U({type:Array,deep:!0,setter(e,t){if(this.$props.editable||this.$props.draggable){if(Oe(P(e.getBounds()),t))return}e.setBounds(z(t))},getter:e=>P(e.getBounds()),transform:z,clone:!0,equals:Oe,events:["dragging","dragend"]})}}),Be=f(ye,ve).extend({name:"AmapEllipse",amapMeta:{initComponent:async(e,t)=>new e.Ellipse(t),editable:{events:["move","end","adjust"],async loadEditor(){await l("AMap.EllipseEditor")},async initEditor(e,t,n){return new e.EllipseEditor(t,n,this.draggable)},onEdit(e){const t=j(e.target.getCenter());S(this.center,t)||this.$emit("update:center",t);const n=e.target.getRadius();S(this.radius,n)||this.$emit("update:radius",n.slice(0))}}},props:{center:U({type:Array,setter(e,t){if(this.$props.editable||this.$props.draggable){if(S(t,j(e.getCenter())))return}e.setCenter(t)},getter:e=>j(e.getCenter()),clone:!0,deep:!0,equals:S,events:["dragging","dragend"]}),radius:U({type:Array,setter(e,t){const n=e;if(this.$props.editable){if(S(t,n.getRadius()))return}n.setRadius(t)},clone:!0,deep:!0,equals:S})}});function Le(e,t,n){if(!e)return n;var o,r;if(Array.isArray(t)&&(o=t.slice(0)),"string"==typeof t&&(o=t.split(".")),"symbol"==typeof t&&(o=[t]),!Array.isArray(o))throw new Error("props arg must be an array, a string or a symbol");for(;o.length;){if(r=o.shift(),!e)return n;if(void 0===(e=e[r]))return n}return e}var _e=f(te,Y(!0,"open","close")).extend({name:"AmapInfoWindow",amapMeta:{slot:!0,async initComponent(e,t){const n={...t},o=Le(this.$slots,"default.0.elm");return n.isCustom&&o&&(n.content=o),new e.InfoWindow(n)},events:["change","open","close"]},props:{isCustom:{type:Boolean,default:void 0},autoMove:{type:Boolean,default:void 0},avoid:U({type:Array}),closeWhenClickMap:{type:Boolean,default:void 0},content:U("setContent",String),size:U({type:Array,transform:e=>new window.AMap.Size(e[0],e[1])}),anchor:U({type:String,setter:"setAnchor",validator:e=>ne.includes(e)}),offset:U({type:Array,transform:e=>new window.AMap.Pixel(e[0],e[1])}),position:U({type:Array,deep:!0,setter(e,t){if(!t)return;const n=e.getPosition();n&&S(t,j(n))||e.setPosition([t[0],t[1]])},getter:e=>j(e.getPosition()),equals:k})},methods:{open(){this.$context.ready.then(e=>{const t=this.position;e.open(this.$map,t)})},close(){this.$context.ready.then(e=>{e.close()})},onOpen(){this.visible||this.$emit("update:visible",!0)},onClose(){this.visible&&this.$emit("update:visible",!1)},_updateContent(){this.visible&&this.$nextTick(()=>{const e=Le(this.$slots,"default.0.elm",this.content);this.$context.ready.then(t=>{t.setContent(e)})})}},async mounted(){const e=await this.$context.ready;this.visible&&(this._updateContent(),this.open()),e.on("open",this.onOpen),e.on("close",this.onClose)},watch:{visible:"_updateContent",content:"_updateContent"}}),je=f(J,Y(!0),Q,X,ee).extend({amapMeta:{events:["complete"]},props:{tileSize:{type:Number}},async mounted(){await this.$context.ready,this.$context.destroyed||this.visible||this.$target.hide()}}),Pe=f(je).extend({name:"AmapTileLayer",amapMeta:{initComponent:async(e,t)=>new e.TileLayer(t)},props:{tileUrl:U({type:String,setter:"setTileUrl"}),dataZooms:U({type:Array})}}),Te=f(je).extend({name:"AmapSatelliteLayer",amapMeta:{initComponent:async(e,t)=>new e.TileLayer.Satellite(t)}}),ze=f(je).extend({name:"AmapFlexibleLayer",amapMeta:{initComponent:async(e,t)=>new e.TileLayer.Flexible(t)},props:{createTile:{type:Function},cacheSize:{type:Number}}}),De=f(je).extend({name:"AmapRoadNetLayer",amapMeta:{initComponent:async(e,t)=>new e.TileLayer.RoadNet(t)}}),Ne=f(je).extend({name:"AmapTrafficLayer",amapMeta:{initComponent:async(e,t)=>new e.TileLayer.Traffic(t)},props:{autoRefresh:{type:Boolean,default:void 0},interval:{type:Number}}});const Ie=["LT","RT","LB","RB"],Re=f(J,Y(!0)).extend({amapMeta:{add(e,t){e.target.addControl(t)},remove(e,t){e.target.removeControl(t)},events:["show","hide"]}}),qe=t.extend({props:{offset:U({type:Array})}}),We=t.extend({props:{position:U({type:[Object,String],validator:e=>"object"==typeof e||Ie.includes(e)})}});var Ze=f(Re).extend({name:"AmapMapType",amapMeta:{prepare:()=>l("AMap.MapType"),initComponent:async(e,t)=>new e.MapType(t)},props:{defaultType:{type:Number},showTraffic:{type:Boolean,default:void 0},showRoad:{type:Boolean,default:void 0}}}),Fe=f(Re,qe,We).extend({name:"AmapControlBar",amapMeta:{prepare:()=>l("AMap.ControlBar"),initComponent:async(e,t)=>new e.ControlBar(t)},props:{showControlButton:{type:Boolean,default:void 0}}}),Ue=f(Re,qe,We).extend({name:"AmapHawkEye",amapMeta:{prepare:()=>l("AMap.HawkEye"),initComponent:async(e,t)=>new e.HawkEye(t)},props:{visible:U({type:Boolean,default:!0,setter(e,t){const n=e;t?n.show():n.hide()}}),isOpen:U({type:Boolean,default:void 0,setter(e,t){const n=e;t?n.open():n.hide()}}),autoMove:{type:Boolean,default:void 0},showRectangle:{type:Boolean,default:void 0},showButton:{type:Boolean,default:void 0},mapStyle:{type:String,default:void 0},layers:{type:Array,default:void 0},width:{type:String,default:void 0},height:{type:String,default:void 0},borderStyle:{type:String,default:void 0},borderColor:{type:String,default:void 0},borderRadius:{type:String,default:void 0},borderWidth:{type:String,default:void 0},buttonSize:{type:String,default:void 0}}}),He=f(Re,qe,We).extend({name:"AmapScale",amapMeta:{prepare:()=>l("AMap.Scale"),initComponent:async(e,t)=>new e.Scale(t)}}),Ve=f(Re,qe,We).extend({name:"AmapToolBar",amapMeta:{prepare:()=>l("AMap.ToolBar"),initComponent:async(e,t)=>new e.ToolBar(t)}});const Ke=new Map,Je=new Map;function Ge(e){const t=Je.get(e);if(!t)return;const{ops:n,milliseconds:o}=t,r=n/o*1e3;console.log(`${e}: ${n}ops, ${o.toFixed(2)}ms, ${r.toFixed(2)}ops/s`)}function Ye(e){n.timing&&performance&&performance.now&&Ke.set(e,performance.now())}function Qe(e,t=1){if(!n.timing)return;if(!performance||!performance.now)return;const o=performance.now(),r=Ke.get(e);if(Ke.delete(e),!r)return;const a=o-r,i=Je.get(e)||{ops:0,milliseconds:0};i.ops+=t||1,i.milliseconds+=a,Je.set(e,i)}"undefined"!=typeof window&&(window.__amap_perf__={start:Ye,stop:Qe,print:function(e){if(console.log("[perf timer statistics]"),e)Ge(e);else for(const e of Je.keys())Ge(e)}});const Xe=le.sealedOptions,et=t.extend({props:Xe.props});let tt=void 0;function nt(e,t,n){const o=e[t];Array.isArray(o)&&(e[t]=new n(o[0],o[1]))}function ot(e){return e&&0!==e.length?e.map(e=>{const t={...e};return nt(t,"size",AMap.Size),nt(t,"offset",AMap.Pixel),nt(t,"imageOffset",AMap.Pixel),t}):e}var rt=f(J).extend({name:"AmapMarkerCluster",amapMeta:{prepare:()=>l("AMap.MarkerCluster"),async initComponent(e,t){const n=this;return this.$scopedSlots.cluster&&(t.renderClusterMarker=n._renderCluster),this.$scopedSlots.marker&&(t.renderMarker=n._renderMarker),new e.MarkerCluster(n.$map,n.data||[],t)},events:["click"]},props:{data:U({type:Array,required:!0,initialize:!1}),gridSize:U("setGridSize",Number),maxZoom:U("setMaxZoom",Number),averageCenter:U({type:Boolean,default:void 0,setter:"setAverageCenter"}),clusterByZoomChange:{type:Boolean,default:void 0},styles:U({type:Array,setter(e,t){e.setStyles(ot(t))},transform:ot}),markerOptions:U({type:Function,initialize:!1}),clusterOptions:U({type:Function,initialize:!1})},data:()=>({$mcc:null}),mounted(){const e=function(e,t,n){let o,r,a,i,s;function p(){var l=Date.now()-i;l<t&&l>=0?o=setTimeout(p,t-l):(o=null,n||(s=e.apply(a,r),a=r=null))}null==t&&(t=100);var l=function(...l){a=this,r=l,i=Date.now();var c=n&&!o;return o||(o=setTimeout(p,t)),c&&(s=e.apply(a,r),a=r=null),s};return l.clear=function(){o&&(clearTimeout(o),o=null)},l.flush=function(){o&&(s=e.apply(a,r),a=r=null,clearTimeout(o),o=null)},l}(this._onDataChange,100),n=this.$scopedSlots.marker,o=this.$scopedSlots.cluster,{$context:r}=this;r.ready.then(()=>{this._onDataChange()});const a=t.extend({props:{point:{type:Object}},render(){if(!n)return null;return Le(n(this.point),"0",null)}}),i=t.extend({props:{context:{type:Object}},render(){if(!o)return null;return Le(o(this.context),"0",null)}});this.$mcc={marker:new a,cluster:new i,dummy:new et},this.$watch("data",{handler:e})},beforeDestroy(){this.$mcc.marker.$destroy(),this.$mcc.cluster.$destroy(),this.$mcc.dummy.$destroy()},methods:{async _onDataChange(){const{data:e,$context:t}=this;await t.ready,t.destroyed||this.$target.setData(e)},_renderMarkerContent(e,t,n){Ye("MarkerCluster#_renderMarkerContent");const o=function(e,t){tt||(tt=document.createElement("div"));const n=e;return n._props=t,n._vnode=null,n.$mount(tt),n._vnode.elm}(t,n);e.marker.setContent(o),Qe("MarkerCluster#_renderMarkerContent")},_setMarkerOptions(e,t,n){const o={};"function"==typeof t&&Object.assign(o,t(n));const r=Object.keys(o),{dummy:a}=this.$mcc;for(let t=0;t<r.length;++t){const n=r[t],i=o[n],s=Xe.props[n];void 0!==s&&Z(a,e.marker,s,i)}},_renderMarker(e){Ye("MarkerCluster#_renderMarker");const t=e.data[0],n={point:t};this._renderMarkerContent(e,this.$mcc.marker,n),this._setMarkerOptions(e,this.markerOptions,t),Qe("MarkerCluster#_renderMarker")},_renderCluster(e){Ye("MarkerCluster#_renderCluster");const t={context:e};this._renderMarkerContent(e,this.$mcc.cluster,t),this._setMarkerOptions(e,this.clusterOptions,e),Qe("MarkerCluster#_renderCluster")}},render:()=>null});const at=le.sealedOptions,it=Ce.sealedOptions,st=Me.sealedOptions,pt=Se.sealedOptions,lt=be.sealedOptions;var ct=f(J).extend({amapMeta:{prepare:()=>l("AMap.MouseTool"),async initComponent(e){return new e.MouseTool(this.$map)},add(){},remove(){}},props:{mode:U({type:String,default:"none"}),clearWhenClose:{type:Boolean,default:!0},options:{type:Object}},data:()=>({drawingMode:void 0}),computed:{$mousetool(){return this.$target}},methods:{close(e){this.$mousetool.close(e)},draw(){const{$mousetool:e,mode:t,drawingMode:n}=this;if(t!==n){switch(t){case"none":this.close(this.clearWhenClose);break;case"marker":e.marker(_(this,at.props,this.options||{}));break;case"polyline":e.polyline(_(this,it.props,this.options||{}));break;case"polygon":e.polygon(_(this,st.props,this.options||{}));break;case"rectangle":e.rectangle(_(this,pt.props,this.options||{}));break;case"circle":e.circle(_(this,lt.props,this.options||{}));break;case"rule":e.rule(_(this,st.props,this.options||{}));break;case"measureArea":e.measureArea(_(this,st.props,this.options||{}));break;case"rectZoomIn":e.rectZoomIn(_(this,st.props,this.options||{}));break;case"rectZoomOut":e.rectZoomOut(_(this,st.props,this.options||{}))}this.drawingMode=t}},_onDraw(e){if(this.mode!==this.drawingMode)return this.close(!0),void this.draw();const t=e.obj,n=this.drawingMode;let o=t;switch(n){case"marker":o=j(t.getPosition());break;case"polyline":case"polygon":o=T(t.getPath());break;case"rectangle":o=P(t.getBounds());break;case"circle":o={center:j(t.getCenter()),radius:t.getRadius()};break;case"rule":o={path:T(t.getPath()),length:t.getLength()};break;case"measureArea":o={path:T(t.getPath()),area:t.getArea()}}this.$emit("draw",n,o),this.$emit("update:mode","none")}},async mounted(){const{$context:e}=this;if(await e.ready,e.destroyed)return;const{$mousetool:t}=this;t.on("draw",this._onDraw),this.$watch("mode",e=>{"none"!==e&&"none"!==this.drawingMode&&this.close(!0),this.draw()},{immediate:!0})}}),dt=f(J,Y(!0),Q,X,ee).extend({amapMeta:{events:["complete"]},async mounted(){await this.$context.ready,this.$context.destroyed||this.visible||this.$target.hide()}}),ut=f(dt).extend({name:"AmapImageLayer",amapMeta:{initComponent:async(e,t)=>new e.ImageLayer(t)},props:{bounds:U({type:Array,transform:z,deep:!0,setter(e,t){e.setBounds(z(t))}}),url:U("setImageUrl",String)}}),mt=f(dt).extend({name:"AmapCanvasLayer",amapMeta:{slot:!0,async initComponent(e,t){const n=Le(this,"$slots.default.0.elm");if(!n||"CANVAS"!==n.tagName)throw this.$amap.logger.warn("slot内容必须是canvas"),new Error;return t.canvas=n,new e.CanvasLayer(t)}},props:{bounds:U({type:Array,transform:z})}}),yt=f(dt).extend({name:"AmapCustomLayer",amapMeta:{slot:!0,async initComponent(e,t){const n=Le(this,"$slots.default.0.elm");if(!n||"CANVAS"!==n.tagName)throw this.$amap.logger.warn("slot内容必须是canvas"),new Error;return new e.CustomLayer(n,t)}},props:{render:U({type:Function,required:!0})}}),ft=f(J,Y(!0),Q,X,ee).extend({amapMeta:{prepare:()=>l("AMap.DistrictLayer"),events:["complete"]},props:{styles:U({type:Object,setter:"setStyles"})}});const ht=t.extend({props:{depth:{type:Number}}});var gt=f(ft).extend({name:"AmapDistrictLayerWorld",amapMeta:{initComponent:async(e,t)=>new e.DistrictLayer.World(t)}}),vt=f(ft,ht).extend({name:"AmapDistrictLayerCountry",amapMeta:{initComponent:async(e,t)=>("soc"in t&&(t.SOC=t.soc,delete t.soc),new e.DistrictLayer.Country(t))},props:{soc:U("setSOC",String)}}),bt=f(ft,ht).extend({name:"AmapDistrictLayerProvince",amapMeta:{initComponent:async(e,t)=>new e.DistrictLayer.Province(t)},props:{adcode:U({type:[Array,String,Number],deep:!0,equals:x,setter:"setDistricts"})}}),wt={install(e){e.component("amap",V),e.component("amap-marker",le),e.component("amap-labels-layer",ce),e.component("amap-label-marker",de),e.component("amap-text",ue),e.component("amap-circle",be),e.component("amap-circle-marker",we),e.component("amap-polygon",Me),e.component("amap-polyline",Ce),e.component("amap-bezier-curve",Ee),e.component("amap-rectangle",Se),e.component("amap-ellipse",Be),e.component("amap-info-window",_e),e.component("amap-tile-layer",Pe),e.component("amap-satellite-layer",Te),e.component("amap-road-net-layer",De),e.component("amap-traffic-layer",Ne),e.component("amap-flexible-layer",ze),e.component("amap-map-type",Ze),e.component("amap-control-bar",Fe),e.component("amap-hawk-eye",Ue),e.component("amap-scale",He),e.component("amap-tool-bar",Ve),e.component("amap-marker-cluster",rt),e.component("amap-mouse-tool",ct),e.component("amap-image-layer",ut),e.component("amap-canvas-layer",mt),e.component("amap-custom-layer",yt),e.component("amap-district-layer-world",gt),e.component("amap-district-layer-country",vt),e.component("amap-district-layer-province",bt)},config:n,loadAmap:p,loadPlugins:l,withAmap:c,Amap:V,Marker:le,LabelsLayer:ce,LabelMarker:de,Text:ue,Circle:be,CircleMarker:we,Polygon:Me,Polyline:Ce,BezierCurve:Ee,Rectangle:Se,Ellipse:Be,InfoWindow:_e,TileLayer:Pe,SatelliteLayer:Te,FlexibleLayer:ze,RoadNetLayer:De,TrafficLayer:Ne,MapType:Ze,ControlBar:Fe,HawkEye:Ue,Scale:He,ToolBar:Ve,MarkerCluster:rt,MouseTool:ct,ImageLayer:ut,CanvasLayer:mt,CustomLayer:yt,DistrictLayerWorld:gt,DistrictLayerCountry:vt,DistrictLayerProvince:bt};e.Amap=V,e.BezierCurve=Ee,e.CanvasLayer=mt,e.Circle=be,e.CircleMarker=we,e.ControlBar=Fe,e.CustomLayer=yt,e.DistrictLayerCountry=vt,e.DistrictLayerProvince=bt,e.DistrictLayerWorld=gt,e.Ellipse=Be,e.FlexibleLayer=ze,e.HawkEye=Ue,e.ImageLayer=ut,e.InfoWindow=_e,e.LabelMarker=de,e.LabelsLayer=ce,e.MapType=Ze,e.Marker=le,e.MarkerCluster=rt,e.MouseTool=ct,e.Polygon=Me,e.Polyline=Ce,e.Rectangle=Se,e.RoadNetLayer=De,e.SatelliteLayer=Te,e.Scale=He,e.Text=ue,e.TileLayer=Pe,e.ToolBar=Ve,e.TrafficLayer=Ne,e.config=n,e.default=wt,e.loadAmap=p,e.loadPlugins=l,e.withAmap=c,Object.defineProperty(e,"__esModule",{value:!0})}));
